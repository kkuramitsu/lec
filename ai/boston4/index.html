
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="数理・データサイエンス・AI入門">
      
      
        <meta name="author" content="倉光君郎">
      
      
        <link rel="canonical" href="https://kkuramitsu.github.io/lec/ai/boston4/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.7">
    
    
      
        <title>統計からAIへ - 数理・データサイエンス・AI入門</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.cd566b2a.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://fonts.googleapis.com/earlyaccess/notosansjp.css">
    
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:600,800">
    
      <link rel="stylesheet" href="../css/custom.css">
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ai" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="数理・データサイエンス・AI入門" class="md-header__button md-logo" aria-label="数理・データサイエンス・AI入門" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            数理・データサイエンス・AI入門
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              統計からAIへ
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="数理・データサイエンス・AI入門" class="md-nav__button md-logo" aria-label="数理・データサイエンス・AI入門" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    数理・データサイエンス・AI入門
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        はじめに
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../boston/" class="md-nav__link">
        データ分析
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../boston2/" class="md-nav__link">
        散布図と相関係数
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../student/" class="md-nav__link">
        コースワーク１
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../boston3/" class="md-nav__link">
        線形回帰
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          統計からAIへ
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        統計からAIへ
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    未来を予測する
  </a>
  
    <nav class="md-nav" aria-label="未来を予測する">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    重回帰分析
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    ホールドアウト法
  </a>
  
    <nav class="md-nav" aria-label="ホールドアウト法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    訓練データと学習
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    テストデータと評価
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    過学習のチェック
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    交差検証⭐️
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    決定木
  </a>
  
    <nav class="md-nav" aria-label="決定木">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    決定木のしくみ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    決定木の利用法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    重要度
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    木の深さを調整する⭐️
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    練習問題⭐️⭐️
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../lunch/" class="md-nav__link">
        コースワーク２
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../class/" class="md-nav__link">
        ２クラス分類
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../kaggle/" class="md-nav__link">
        Kaggleに挑戦
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../mnist/" class="md-nav__link">
        画像認識とMNIST
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../nn/" class="md-nav__link">
        ニューラルネットワーク⭐️⭐️
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../mnist/" class="md-nav__link">
        コースワーク３
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../corpus/" class="md-nav__link">
        データ資源とコーパス
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../pandas/" class="md-nav__link">
        データ処理
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../nlp/" class="md-nav__link">
        自然言語処理
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../mnist/" class="md-nav__link">
        コースワーク４
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../nn/" class="md-nav__link">
        より本格的なAIへ
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    未来を予測する
  </a>
  
    <nav class="md-nav" aria-label="未来を予測する">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    重回帰分析
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    ホールドアウト法
  </a>
  
    <nav class="md-nav" aria-label="ホールドアウト法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    訓練データと学習
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    テストデータと評価
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    過学習のチェック
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    交差検証⭐️
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    決定木
  </a>
  
    <nav class="md-nav" aria-label="決定木">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    決定木のしくみ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    決定木の利用法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    重要度
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    木の深さを調整する⭐️
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    練習問題⭐️⭐️
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

<h1 id="ai">統計からAIへ<a class="headerlink" href="#ai" title="Permanent link">#</a></h1>
<p>単回帰と重回帰分析は、もともと統計学の分野で研究されてきた手法です。
統計学では、過去のデータを解釈することを重視します。
AIでは、過去のデータを解釈することより、
<strong>未来（未知のデータ）を正しく予測すること</strong> を重視します。</p>
<p>今回は、AIの流儀にしたがって、より正確に予測できるモデルを作る方法を見ていきます。</p>
<p>さて、今回もデータセットは、ボストン住宅価格データセットを使います。
演習が始まる前にデータセットをダウンロードして、必要なモジュールをインポートしておいてください。</p>
<div class="highlight"><span class="filename">データセットの準備完了</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>df = pd.read_csv(&#39;boston.csv&#39;)
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>df.drop(&#39;黒人&#39;, axis=1, inplace=True)
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>df.head()
</code></pre></div>
<p>もうボストン住宅価格データセットは飽きた方のために、
<a href="../lunch/">コースワーク２</a>では、別のデータセットの練習を用意してあります。</p>
<h2 id="_1">未来を予測する<a class="headerlink" href="#_1" title="Permanent link">#</a></h2>
<p>機械学習やAIの開発では、<strong>過学習</strong> という現象が非常に嫌われています。
これは、予測モデルが過去のデータである訓練データに過剰に適合し過ぎてしまって、
未来の新しいデータへの予測があまり正確にできなくなる現象です。</p>
<div class="admonition example">
<p class="admonition-title">過学習</p>
<p>過去問ばかり繰り返し練習しても、本番の試験の問題は解けませんよね。</p>
</div>
<p>機械学習やAIでは、過去のデータではなく、
未来の<strong>未知のデータ</strong>に対する予測モデルの開発が重要になります。
<strong>ホールドアウト法</strong>という未知のデータに対する汎化性能を評価する手法を紹介します。</p>
<h3 id="_2">重回帰分析<a class="headerlink" href="#_2" title="Permanent link">#</a></h3>
<p>まず、前回の回帰分析をを思い出しながら
<code>'住宅価格'</code>を目的変数、それ以外の１２次元のデータ列を説明変数とした重回帰モデルを作ってみます。</p>
<p><div class="highlight"><span class="filename">１２次元データの重回帰モデル</span><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>  <span class="c1"># 価格以外を全て説明変数に</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;住宅価格&#39;</span><span class="p">]</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;説明変数:&#39;</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="s1">&#39;次元:&#39;</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MSE: &quot;</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;R2&#39;</span><span class="p">,</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>説明変数: Index([&#39;犯罪率&#39;, &#39;緑地&#39;, &#39;工場&#39;, &#39;川近&#39;, &#39;大気汚染&#39;, &#39;部屋数&#39;, &#39;築年&#39;, &#39;通勤&#39;, 
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>    &#39;交通&#39;, &#39;資産税&#39;, &#39;教員比&#39;,&#39;低所得率&#39;], dtype=&#39;object&#39;) 次元: (506, 12)
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>MSE:  22.429681439489933
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>R2 0.7343070437613075
</code></pre></div></p>
<p>決定係数(R2)を<strong>ベースライン</strong>にしましょう。
ここから、過学習を防ぎながら、
決定係数が高い回帰モデルを作る方法をみていきたいと思います。</p>
<h2 id="_3">ホールドアウト法<a class="headerlink" href="#_3" title="Permanent link">#</a></h2>
<p>人工知能では、過去に学習したデータではなく、
未来の<strong>未知のデータ</strong> に対する予測精度が重要になります。</p>
<p><strong>ホールドアウト法</strong> は、
全データを訓練データとテストデータに分割することで、モデルの精度を評価する方法です。</p>
<p><img alt="" src="https://data-analysis-stats.jp/wp-content/uploads/2019/11/ホールドアウト検証.png" /></p>
<p>テストデータを未知として学習に使わないことで、未知のデータに対する精度が測定できるようになります。</p>
<ul>
<li><strong>訓練データ</strong>: モデルを学習するためのデータ</li>
<li><strong>テストデータ</strong>: モデルを評価するためのデータ</li>
</ul>
<p>sklearn には、
ランダムにデータを訓練データとテストデータに分割する関数<code>train_test_split()</code>があります。
この関数を使って、訓練データとテストデータを分割します。</p>
<p><strong>訓練データとテストデータに分割</strong></p>
<ul>
<li><code>test_size</code>: 訓練用(70%),テスト用(30%)</li>
<li><code>random_state=0</code>: 乱数の生成を固定し、毎回同じ乱数で分割させる</li>
</ul>
<p><div class="highlight"><span class="filename">訓練データとテストデータに分割</span><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;訓練データ数:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_train</span><span class="p">))</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;テストデータ数:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>訓練データ数: 354
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>テストデータ数: 152
</code></pre></div></p>
<h3 id="_4">訓練データと学習<a class="headerlink" href="#_4" title="Permanent link">#</a></h3>
<p>学習は、<strong>訓練データ</strong>に対してのみ行います。
テストデータで学習することは、
機械学習ではカンニング（チート）行為になります。</p>
<div class="highlight"><span class="filename">訓練データの実行</span><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</code></pre></div>
<h3 id="_5">テストデータと評価<a class="headerlink" href="#_5" title="Permanent link">#</a></h3>
<p>テストデータ <code>X_test</code>と<code>y_test</code>は、モデルの学習には一切使われていません。
だから、学習済みモデルにとって、未知の未来に来るかもしれないデータに相当します。</p>
<p>モデルの評価は、このようなテストデータを用いて行います。</p>
<ul>
<li><code>X_test</code>: テストデータの説明変数</li>
<li><code>y_test</code>:  テストデータの目的変数（つまり、正解）</li>
<li><code>y_pred:</code>: モデルから予測されたデータ列</li>
</ul>
<p><div class="highlight"><span class="filename">テストデータの決定係数(R2)</span><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>y_pred = model.predict(X_test)
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>print(&quot;MSE(テスト): &quot;, mean_squared_error(y_test, y_pred) ) 
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>print(&#39;R2(テスト):&#39;, r2_score(y_test, y_pred))
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>MSE(テスト):  28.14679026854114
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>R2(テスト): 0.6619633616256454
</code></pre></div></p>
<p>MSE(テスト)やR2(テスト)は、学習していない未知データに対する精度になります。
このような未知のデータへの指標を<strong>汎化性能</strong>といいます。</p>
<h3 id="_6">過学習のチェック<a class="headerlink" href="#_6" title="Permanent link">#</a></h3>
<p>過学習は、訓練データを過度に学習してしまう現象です。
こちらは、少しややこしいですが、訓練データの精度と比較してみることで確認します。</p>
<p><div class="highlight"><span class="filename">過学習のチェック</span><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>print(&#39;R2(訓練):&#39;, r2_score(y_train, model.predict(X_train)))
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>print(&#39;R2(テスト):&#39;, r2_score(y_test, y_pred))
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>R2(訓練): 0.7614925768121829
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>R2(テスト): 0.6619633616256454
</code></pre></div></p>
<p>訓練データのスコアが、テストデータに比べて明らかに高いときは、<strong>過学習</strong>を疑いましょう。
ちなみに、今回、作成した重回帰モデルでは、明らかに訓練データのスコアの方が高いです。
そのため、<strong>過学習を疑うべき</strong>事案となります。</p>
<div class="admonition note">
<p class="admonition-title">過学習の防ぎ方</p>
<p>過学習は、学習があまり進まないようにパラメータを調整することで防ぎます。
機械学習のアルゴリズムによって、防ぎ方は異なります。</p>
</div>
<h3 id="_7">交差検証⭐️<a class="headerlink" href="#_7" title="Permanent link">#</a></h3>
<p>交差検証（クロスバリデーション, CV)は、訓練データとテストデータに分割する点は同じです。</p>
<p>データをまずK個に分割して、そのうちひとつだけををテストデータ、残りを訓練データとして、
学習・評価します。２回目は、テストデータを切り替えてk回評価します。
そして、各回で測定したスコアの平均でモデルの評価をする方法です。</p>
<p><img alt="" src="https://data-analysis-stats.jp/wp-content/uploads/2019/11/交差検証2.png" /></p>
<p>sklearn では、<code>cross_val_score</code>として関数が用意されています。
これはすごく便利な関数で、必要なパラメータを渡せば、あとは勝手に計算してくれます。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>cross_val_score(モデル, X, y, cv=5, scoring=&#39;r2&#39;)
</code></pre></div>
<p>ひとつ注意する点は、データをそのままk等分してしまう点です。
データに偏りがあると、期待した結果にならないことがあります。
何か変だなと思ったら、事前にランダム化しておきましょう。</p>
<p><div class="highlight"><span class="filename">線形回帰のクロスバリデーション</span><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_validate</span><span class="p">,</span> <span class="n">cross_val_score</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span> <span class="c1">#500個ほどサンプリング</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>  <span class="c1"># 価格以外を全て説明変数に</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;住宅価格&#39;</span><span class="p">]</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">LinearRegression</span><span class="p">(),</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;r2&#39;</span><span class="p">)</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="nb">print</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>[0.7008421  0.60231973 0.76837893 0.70741722 0.72919493]
</code></pre></div></p>
<p><code>cross_val_score()</code>の結果は、5回分のスコアで帰ってきます。
この平均を計算すればよいのですが、boxplot などを表示しても面白いです。
詳しくは、演習問題を参考にしてください。</p>
<h2 id="_8">決定木<a class="headerlink" href="#_8" title="Permanent link">#</a></h2>
<p>今まで、データサイエンスと機械学習の基礎中として、線形回帰（単回帰と重回帰）を紹介しました。
しかし、機械学習アルゴリズムは長足の進歩を遂げているので、
精度のよい回帰モデルを作成したいのなら、線形回帰にこだわる必要はありません。</p>
<p>現在、データサイエンスの業務の場で人気が高いのは、
ランダムフォレスト、XGDBoost、サポートベクターマシンがよく使われています。
一方、AIでは、ニューラルネットワーク系のアルゴリズムが使われています。</p>
<p>ここでは、もうひとつの定番の回帰分析である、<strong>決定木</strong> を紹介したいと思います。</p>
<h3 id="_9">決定木のしくみ<a class="headerlink" href="#_9" title="Permanent link">#</a></h3>
<p>決定木は、ランダムフォレストやXGDBoost の元になっている基本的なアルゴリズムです。
非線形回帰アルゴリズムなので、線形モデルがうまく当てはまらないときの有効な候補になります。</p>
<p><img alt="" src="../figs/boston_tree1-fs8.png" /></p>
<p><img alt="" src="../figs/boston_tree2-fs8.png" /></p>
<h3 id="_10">決定木の利用法<a class="headerlink" href="#_10" title="Permanent link">#</a></h3>
<p>決定木は、<code>sklearn.tree.DecisionTreeRegressor</code>を使います。</p>
<div class="highlight"><span class="filename">決定木(回帰)</span><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeRegressor</span>
</code></pre></div>
<p>あとは、<code>LinearRegression()</code> の代わりに、
<code>DecisionTreeRegressor()</code>を使えば、<code>fit()</code>や<code>predict()</code>などのメソッドは
全く同じように使うことができます。</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">DecisionTreeRegressor</span><span class="p">()</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;R2(訓練):&#39;</span><span class="p">,</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)))</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;R2(テスト):&#39;</span><span class="p">,</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>R2(訓練): 1.0
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>R2(テスト): 0.6597361898690233
</code></pre></div></p>
<p><img alt="" src="../figs/boston_tree_scatter-fs8.png" /></p>
<p>訓練データは、素晴らしいスコアを出しましたが、過学習ですね。たぶん。</p>
<p>ちなみに決定木を表示するときは、次のように<code>plot_tree</code>を使います。</p>
<div class="highlight"><span class="filename">決定木を表示する</span><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>from sklearn.tree import plot_tree
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>plot_tree(model, feature_names=X.columns, filled=True)
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>plt.show()
</code></pre></div>
<p><img alt="" src="../figs/boston_tree1-fs8.png" /></p>
<div class="admonition warning">
<p class="admonition-title">maxdepth</p>
<p>上の図は、<code>DecisionTreeRegressor(maxdepth=2)</code>で学習したときです。
何も指定しないと無制限に木を分割していきます。</p>
</div>
<h3 id="_11">重要度<a class="headerlink" href="#_11" title="Permanent link">#</a></h3>
<p>決定木の面白いところは、どの説明変数がモデルに寄与しているか簡単に
可視化できる点です。</p>
<div class="admonition note">
<p class="admonition-title">重要度(importance)</p>
<p>特徴量の分割がターゲットの分類にどれくらい寄与しているかを測る指標</p>
</div>
<p>決定木モデルの学習が終わると、<code>feature_importances_</code>に
各説明変数ごとの重要度が算出されて記録されています。</p>
<p><div class="highlight"><span class="filename">重要度を取り出して表示していみる</span><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="k">for</span> <span class="n">column</span><span class="p">,</span> <span class="n">importance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">):</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">importance</span><span class="si">:</span><span class="s1">.5f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="nb">print</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">))</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>犯罪率 0.08447
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>緑地 0.00049
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>工場 0.00882
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>川近 0.00026
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>大気汚染 0.02107
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>部屋数 0.60087
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>築年 0.00893
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>通勤 0.05647
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a>交通 0.00276
<a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a>資産税 0.00792
<a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a>教員比 0.03026
<a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a>低所得率 0.17767
<a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a>1.0
</code></pre></div></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>重要度は、合計が1.0になるように正規化されています。</p>
</div>
<p>棒グラフに表示してみると、より視覚的に確認しやすいでしょう。</p>
<div class="highlight"><span class="filename">棒グラフで表示</span><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>plt.figure(figsize=(12, 6))
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>plt.barh(X_train.columns, model.feature_importances_)
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>plt.show()
</code></pre></div>
<p><img alt="重要度" src="../figs/boston_tree_importance-fs8.png" /></p>
<h3 id="_12">木の深さを調整する⭐️<a class="headerlink" href="#_12" title="Permanent link">#</a></h3>
<p>決定木は、<code>maxdepth</code>というパラメータを調整することで、
学習を進める深さを調整できます。</p>
<div class="highlight"><span class="filename">例. 深さを3までにする</span><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">maxdepth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">ハイパーパラメータ</p>
<p>データサイエンティストやAIエンジニアがモデルを作成する前に設定すべきパラメータのこと</p>
</div>
<p>ハイパーパラメータの調整がデータサイエンティストやAIエンジニアの腕の見せ所です。
もちろん、手作業で調整するよりは、簡単なプログラムを組んで調べるようにします。</p>
<p><div class="highlight"><span class="filename">maxdepthの調整</span><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="n">y2</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="k">for</span> <span class="n">depth</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">):</span>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>    <span class="n">model</span> <span class="o">=</span> <span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="n">depth</span><span class="p">)</span>  <span class="c1"># None 制限なし</span>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>    <span class="n">r2_train</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">))</span>
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>    <span class="n">r2_test</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>    <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r2_train</span><span class="p">)</span>
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a>    <span class="n">y2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r2_test</span><span class="p">)</span>
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;depth=</span><span class="si">{</span><span class="n">depth</span><span class="si">}</span><span class="s1">, R2(train)=</span><span class="si">{</span><span class="n">r2_train</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">, R2(test)=</span><span class="si">{</span><span class="n">r2_test</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a>
<a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">),</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;訓練&#39;</span><span class="p">)</span>
<a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="n">y2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;テスト&#39;</span><span class="p">)</span>
<a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;深さ&#39;</span><span class="p">)</span>
<a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>depth=1, R2(train)=0.4694, R2(test)=0.3723
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>depth=2, R2(train)=0.7204, R2(test)=0.6226
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>depth=3, R2(train)=0.8511, R2(test)=0.6629
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a>depth=4, R2(train)=0.8992, R2(test)=0.6739
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a>depth=5, R2(train)=0.9265, R2(test)=0.7109
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a>depth=6, R2(train)=0.9523, R2(test)=0.7166
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a>depth=7, R2(train)=0.9692, R2(test)=0.7028
<a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a>depth=8, R2(train)=0.9833, R2(test)=0.6818
<a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a>depth=9, R2(train)=0.9904, R2(test)=0.6324
<a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a>depth=10, R2(train)=0.9951, R2(test)=0.6593
</code></pre></div></p>
<p><img alt="" src="../figs/boston_tree_train_test-fs8.png" /></p>
<div class="admonition warning">
<p class="admonition-title">ハイパーパラメータの調整</p>
<p>ところで、上のようなプログラムがすらすらとかけると、Python力は実務レベルです。
ただし、何事にも便利なライブラリが用意されています。グリッドサーチを調べてください。</p>
</div>
<p>どのあたりから過学習と判断するか難しいところです。
「ひとつの基準としてテストデータのスコアが上がらなくなったら学習を止める」
という考え方があります。
AIの目的によっても、過学習の判断基準は変わってきます。</p>
<h2 id="_13">練習問題⭐️⭐️<a class="headerlink" href="#_13" title="Permanent link">#</a></h2>
<div class="admonition danger">
<p class="admonition-title">コースワーク</p>
<p>今週は、<a href="../lunch/">コースワーク２</a>があります。
まずは、そちらを優先して、取り組んでください。</p>
</div>
<p>sklearnには、回帰モデルを28種類あります。
それらを全部試して、精度を比較してしてみてみましょう。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span><span class="p">,</span> <span class="n">Ridge</span><span class="p">,</span> <span class="n">Lasso</span><span class="p">,</span> <span class="n">ElasticNet</span><span class="p">,</span> <span class="n">SGDRegressor</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">PassiveAggressiveRegressor</span><span class="p">,</span> <span class="n">ARDRegression</span><span class="p">,</span> <span class="n">RidgeCV</span>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">TheilSenRegressor</span><span class="p">,</span> <span class="n">RANSACRegressor</span><span class="p">,</span> <span class="n">HuberRegressor</span>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPRegressor</span>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVR</span><span class="p">,</span> <span class="n">LinearSVR</span>
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="kn">from</span> <span class="nn">sklearn.gaussian_process</span> <span class="kn">import</span> <span class="n">GaussianProcessRegressor</span>
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeRegressor</span>
<a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="kn">from</span> <span class="nn">sklearn.experimental</span> <span class="kn">import</span> <span class="n">enable_hist_gradient_boosting</span>
<a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span><span class="p">,</span> <span class="n">AdaBoostRegressor</span><span class="p">,</span> <span class="n">ExtraTreesRegressor</span><span class="p">,</span> <span class="n">HistGradientBoostingRegressor</span>
<a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">BaggingRegressor</span><span class="p">,</span> <span class="n">GradientBoostingRegressor</span><span class="p">,</span> <span class="n">VotingRegressor</span><span class="p">,</span> <span class="n">StackingRegressor</span>
<a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">PolynomialFeatures</span>
<a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a><span class="kn">from</span> <span class="nn">sklearn.cross_decomposition</span> <span class="kn">import</span> <span class="n">PLSRegression</span>
<a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a>
<a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a><span class="n">reg_dict</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-23-17" name="__codelineno-23-17" href="#__codelineno-23-17"></a>    <span class="s2">&quot;LinearRegression&quot;</span><span class="p">:</span> <span class="n">LinearRegression</span><span class="p">(),</span>
<a id="__codelineno-23-18" name="__codelineno-23-18" href="#__codelineno-23-18"></a>        <span class="s2">&quot;Ridge&quot;</span><span class="p">:</span> <span class="n">Ridge</span><span class="p">(),</span>
<a id="__codelineno-23-19" name="__codelineno-23-19" href="#__codelineno-23-19"></a>        <span class="s2">&quot;Lasso&quot;</span><span class="p">:</span> <span class="n">Lasso</span><span class="p">(),</span>
<a id="__codelineno-23-20" name="__codelineno-23-20" href="#__codelineno-23-20"></a>        <span class="s2">&quot;ElasticNet&quot;</span><span class="p">:</span> <span class="n">ElasticNet</span><span class="p">(),</span> 
<a id="__codelineno-23-21" name="__codelineno-23-21" href="#__codelineno-23-21"></a>        <span class="s2">&quot;Polynomial_deg2&quot;</span><span class="p">:</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;poly&#39;</span><span class="p">,</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)),(</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">LinearRegression</span><span class="p">())]),</span>
<a id="__codelineno-23-22" name="__codelineno-23-22" href="#__codelineno-23-22"></a>        <span class="s2">&quot;Polynomial_deg3&quot;</span><span class="p">:</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;poly&#39;</span><span class="p">,</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">3</span><span class="p">)),(</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">LinearRegression</span><span class="p">())]),</span>
<a id="__codelineno-23-23" name="__codelineno-23-23" href="#__codelineno-23-23"></a>        <span class="s2">&quot;Polynomial_deg4&quot;</span><span class="p">:</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;poly&#39;</span><span class="p">,</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">4</span><span class="p">)),(</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">LinearRegression</span><span class="p">())]),</span>
<a id="__codelineno-23-24" name="__codelineno-23-24" href="#__codelineno-23-24"></a>        <span class="s2">&quot;Polynomial_deg5&quot;</span><span class="p">:</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;poly&#39;</span><span class="p">,</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">5</span><span class="p">)),(</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">LinearRegression</span><span class="p">())]),</span>
<a id="__codelineno-23-25" name="__codelineno-23-25" href="#__codelineno-23-25"></a>        <span class="s2">&quot;KNeighborsRegressor&quot;</span><span class="p">:</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
<a id="__codelineno-23-26" name="__codelineno-23-26" href="#__codelineno-23-26"></a>        <span class="s2">&quot;DecisionTreeRegressor&quot;</span><span class="p">:</span> <span class="n">DecisionTreeRegressor</span><span class="p">(),</span>
<a id="__codelineno-23-27" name="__codelineno-23-27" href="#__codelineno-23-27"></a>        <span class="s2">&quot;RandomForestRegressor&quot;</span><span class="p">:</span> <span class="n">RandomForestRegressor</span><span class="p">(),</span>
<a id="__codelineno-23-28" name="__codelineno-23-28" href="#__codelineno-23-28"></a>        <span class="s2">&quot;SVR&quot;</span><span class="p">:</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.1</span><span class="p">),</span>
<a id="__codelineno-23-29" name="__codelineno-23-29" href="#__codelineno-23-29"></a>        <span class="s2">&quot;GaussianProcessRegressor&quot;</span><span class="p">:</span> <span class="n">GaussianProcessRegressor</span><span class="p">(),</span>
<a id="__codelineno-23-30" name="__codelineno-23-30" href="#__codelineno-23-30"></a>        <span class="s2">&quot;SGDRegressor&quot;</span><span class="p">:</span> <span class="n">SGDRegressor</span><span class="p">(),</span>
<a id="__codelineno-23-31" name="__codelineno-23-31" href="#__codelineno-23-31"></a>        <span class="s2">&quot;MLPRegressor&quot;</span><span class="p">:</span> <span class="n">MLPRegressor</span><span class="p">(</span><span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">early_stopping</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_iter_no_change</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
<a id="__codelineno-23-32" name="__codelineno-23-32" href="#__codelineno-23-32"></a>        <span class="s2">&quot;ExtraTreesRegressor&quot;</span><span class="p">:</span> <span class="n">ExtraTreesRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span> 
<a id="__codelineno-23-33" name="__codelineno-23-33" href="#__codelineno-23-33"></a>        <span class="s2">&quot;PLSRegression&quot;</span><span class="p">:</span> <span class="n">PLSRegression</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
<a id="__codelineno-23-34" name="__codelineno-23-34" href="#__codelineno-23-34"></a>        <span class="s2">&quot;PassiveAggressiveRegressor&quot;</span><span class="p">:</span> <span class="n">PassiveAggressiveRegressor</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">),</span>
<a id="__codelineno-23-35" name="__codelineno-23-35" href="#__codelineno-23-35"></a>        <span class="s2">&quot;TheilSenRegressor&quot;</span><span class="p">:</span> <span class="n">TheilSenRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-23-36" name="__codelineno-23-36" href="#__codelineno-23-36"></a>        <span class="s2">&quot;RANSACRegressor&quot;</span><span class="p">:</span> <span class="n">RANSACRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-23-37" name="__codelineno-23-37" href="#__codelineno-23-37"></a>        <span class="s2">&quot;HistGradientBoostingRegressor&quot;</span><span class="p">:</span> <span class="n">HistGradientBoostingRegressor</span><span class="p">(),</span>
<a id="__codelineno-23-38" name="__codelineno-23-38" href="#__codelineno-23-38"></a>        <span class="s2">&quot;AdaBoostRegressor&quot;</span><span class="p">:</span> <span class="n">AdaBoostRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span>
<a id="__codelineno-23-39" name="__codelineno-23-39" href="#__codelineno-23-39"></a>        <span class="s2">&quot;BaggingRegressor&quot;</span><span class="p">:</span> <span class="n">BaggingRegressor</span><span class="p">(</span><span class="n">base_estimator</span><span class="o">=</span><span class="n">SVR</span><span class="p">(),</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
<a id="__codelineno-23-40" name="__codelineno-23-40" href="#__codelineno-23-40"></a>        <span class="s2">&quot;GradientBoostingRegressor&quot;</span><span class="p">:</span> <span class="n">GradientBoostingRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-23-41" name="__codelineno-23-41" href="#__codelineno-23-41"></a>        <span class="s2">&quot;VotingRegressor&quot;</span><span class="p">:</span> <span class="n">VotingRegressor</span><span class="p">([(</span><span class="s1">&#39;lr&#39;</span><span class="p">,</span> <span class="n">LinearRegression</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;rf&#39;</span><span class="p">,</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">10</span><span class="p">))]),</span>
<a id="__codelineno-23-42" name="__codelineno-23-42" href="#__codelineno-23-42"></a>        <span class="s2">&quot;StackingRegressor&quot;</span><span class="p">:</span> <span class="n">StackingRegressor</span><span class="p">(</span><span class="n">estimators</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;lr&#39;</span><span class="p">,</span> <span class="n">RidgeCV</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;svr&#39;</span><span class="p">,</span> <span class="n">LinearSVR</span><span class="p">())],</span> <span class="n">final_estimator</span><span class="o">=</span><span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">10</span><span class="p">)),</span>
<a id="__codelineno-23-43" name="__codelineno-23-43" href="#__codelineno-23-43"></a>        <span class="s2">&quot;ARDRegression&quot;</span><span class="p">:</span> <span class="n">ARDRegression</span><span class="p">(),</span>
<a id="__codelineno-23-44" name="__codelineno-23-44" href="#__codelineno-23-44"></a>        <span class="s2">&quot;HuberRegressor&quot;</span><span class="p">:</span> <span class="n">HuberRegressor</span><span class="p">(),</span>
<a id="__codelineno-23-45" name="__codelineno-23-45" href="#__codelineno-23-45"></a><span class="p">}</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">どのような機械学習アルゴリズムがあるか調べてみよう</p>
<p>データサイエンティストになるには、最新アルゴリズムに関心をもち、
データセットにあわせて使い分けることも重要です。
研究室の学生をみていると、どんどん色々なアルゴリズムを試してきて、
報告してくれます。教員より詳しいです。</p>
</div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../boston3/" class="md-footer__link md-footer__link--prev" aria-label="Previous: 線形回帰" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              線形回帰
            </div>
          </div>
        </a>
      
      
        
        <a href="../lunch/" class="md-footer__link md-footer__link--next" aria-label="Next: コースワーク２" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              コースワーク２
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright (c) 2021
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.22074ed6.min.js"}</script>
    
    
      <script src="../assets/javascripts/bundle.01de222e.min.js"></script>
      
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
    
  </body>
</html>